<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mind Mate - Your AI Pet Companion</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; }
        .container { max-width: 600px; margin: 0 auto; background: white; border-radius: 20px; padding: 30px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); }
        h1 { color: #667eea; margin-bottom: 10px; font-size: 2em; }
        .subtitle { color: #666; margin-bottom: 30px; }
        .card { background: #f8f9fa; border-radius: 12px; padding: 20px; margin-bottom: 20px; }
        .card h2 { font-size: 1.2em; color: #333; margin-bottom: 15px; }
        label { display: block; margin-bottom: 8px; color: #555; font-weight: 500; }
        input[type="number"], input[type="text"], textarea { width: 100%; padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px; transition: border 0.3s; }
        input:focus, textarea:focus { outline: none; border-color: #667eea; }
        input[type="file"] { padding: 8px; }
        button { background: #667eea; color: white; border: none; padding: 12px 24px; border-radius: 8px; font-size: 16px; cursor: pointer; transition: all 0.3s; font-weight: 600; width: 100%; margin-top: 10px; }
        button:hover { background: #5568d3; transform: translateY(-2px); box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4); }
        button:active { transform: translateY(0); }
        .output { background: #f0f4ff; border-left: 4px solid #667eea; padding: 15px; border-radius: 8px; margin-top: 15px; font-family: monospace; font-size: 14px; white-space: pre-wrap; word-wrap: break-word; max-height: 300px; overflow-y: auto; }
        .mood-slider { width: 100%; height: 8px; border-radius: 4px; background: linear-gradient(to right, #ff6b6b, #ffd93d, #6bcf7f); outline: none; }
        .mood-value { text-align: center; font-size: 2em; color: #667eea; font-weight: bold; margin: 10px 0; }
        .tags { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 10px; }
        .tag { background: #e0e7ff; color: #667eea; padding: 6px 12px; border-radius: 20px; font-size: 14px; cursor: pointer; transition: all 0.2s; }
        .tag.active { background: #667eea; color: white; }
        .emoji { font-size: 3em; text-align: center; margin: 10px 0; }
        .loading { display: none; text-align: center; color: #667eea; margin-top: 10px; }
        .loading.show { display: block; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üêæ Mind Mate</h1>
        <p class="subtitle">Your AI pet companion for mental wellness</p>

        <!-- Mood Logging -->
        <div class="card">
            <h2>üìä How are you feeling today?</h2>
            <div class="emoji" id="moodEmoji">üòä</div>
            <div class="mood-value" id="moodValue">6</div>
            <input type="range" id="mood" class="mood-slider" min="1" max="10" value="6">
            
            <label style="margin-top: 20px;">Tags (click to select)</label>
            <div class="tags" id="tagContainer">
                <span class="tag" data-tag="work">Work</span>
                <span class="tag" data-tag="stress">Stress</span>
                <span class="tag" data-tag="happy">Happy</span>
                <span class="tag" data-tag="tired">Tired</span>
                <span class="tag" data-tag="anxious">Anxious</span>
                <span class="tag" data-tag="calm">Calm</span>
                <span class="tag" data-tag="social">Social</span>
                <span class="tag" data-tag="exercise">Exercise</span>
            </div>
            
            <label style="margin-top: 15px;">Notes (optional)</label>
            <textarea id="notes" rows="3" placeholder="What's on your mind?"></textarea>
            
            <button onclick="sendMood()">üíæ Save Mood</button>
            <div class="loading" id="moodLoading">Saving...</div>
        </div>

        <!-- Selfie Analysis -->
        <div class="card">
            <h2>ü§≥ Analyze Your Selfie</h2>
            <label>Upload a photo</label>
            <input id="file" type="file" accept="image/*">
            <button onclick="sendSelfie()">üîç Analyze Emotions</button>
            <div class="loading" id="selfieLoading">Analyzing...</div>
        </div>

        <!-- Avatar Generator -->
        <div class="card">
            <h2>üé® Generate Your AI Pet Avatar</h2>
            <label>Describe your ideal pet companion</label>
            <input type="text" id="petDescription" placeholder="e.g., a fluffy orange cat with green eyes">
            <button onclick="generateAvatar()">‚ú® Create Avatar</button>
            <div class="loading" id="avatarLoading">Generating...</div>
        </div>

        <!-- Output -->
        <div class="output" id="output">Results will appear here...</div>
    </div>

    <script>
        // REPLACE THIS WITH YOUR API GATEWAY URL
        const API = "https://YOUR_API_ID.execute-api.us-east-1.amazonaws.com";
        
        let selectedTags = [];

        // Mood slider
        const moodSlider = document.getElementById('mood');
        const moodValue = document.getElementById('moodValue');
        const moodEmoji = document.getElementById('moodEmoji');
        
        const emojis = ['üò¢', 'üòü', 'üòï', 'üòê', 'üôÇ', 'üòä', 'üòÑ', 'üòÅ', 'ü§©', 'ü•≥'];
        
        moodSlider.addEventListener('input', (e) => {
            const val = e.target.value;
            moodValue.textContent = val;
            moodEmoji.textContent = emojis[val - 1];
        });

        // Tag selection
        document.getElementById('tagContainer').addEventListener('click', (e) => {
            if (e.target.classList.contains('tag')) {
                e.target.classList.toggle('active');
                const tag = e.target.dataset.tag;
                if (selectedTags.includes(tag)) {
                    selectedTags = selectedTags.filter(t => t !== tag);
                } else {
                    selectedTags.push(tag);
                }
            }
        });

        function showLoading(id, show) {
            document.getElementById(id).classList.toggle('show', show);
        }

        function showOutput(text) {
            document.getElementById('output').textContent = text;
        }

        async function sendMood() {
            showLoading('moodLoading', true);
            try {
                const mood = Number(document.getElementById('mood').value);
                const notes = document.getElementById('notes').value;
                
                const response = await fetch(`${API}/mood`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        userId: 'demo-user',
                        mood: mood,
                        tags: selectedTags,
                        notes: notes
                    })
                });
                
                const data = await response.json();
                showOutput(JSON.stringify(data, null, 2));
                
                if (data.ok) {
                    alert('‚úÖ Mood saved successfully!');
                }
            } catch (error) {
                showOutput(`Error: ${error.message}`);
            } finally {
                showLoading('moodLoading', false);
            }
        }

        async function toBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = () => resolve(reader.result);
                reader.onerror = reject;
                reader.readAsDataURL(file);
            });
        }

        async function sendSelfie() {
            const file = document.getElementById('file').files[0];
            if (!file) {
                alert('Please select a photo first');
                return;
            }
            
            showLoading('selfieLoading', true);
            try {
                const imageBase64 = await toBase64(file);
                
                const response = await fetch(`${API}/selfie`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        userId: 'demo-user',
                        imageBase64: imageBase64
                    })
                });
                
                const data = await response.json();
                showOutput(JSON.stringify(data, null, 2));
                
                if (data.topEmotions) {
                    const emotions = data.topEmotions.map(e => 
                        `${e.Type}: ${e.Confidence.toFixed(1)}%`
                    ).join('\n');
                    alert(`üé≠ Detected emotions:\n${emotions}`);
                }
            } catch (error) {
                showOutput(`Error: ${error.message}`);
            } finally {
                showLoading('selfieLoading', false);
            }
        }

        async function generateAvatar() {
            const description = document.getElementById('petDescription').value;
            if (!description) {
                alert('Please describe your ideal pet companion');
                return;
            }
            
            showLoading('avatarLoading', true);
            try {
                const response = await fetch(`${API}/avatar`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        userId: 'demo-user',
                        description: description
                    })
                });
                
                const data = await response.json();
                showOutput(JSON.stringify(data, null, 2));
                
                if (data.avatarUrl) {
                    alert('‚ú® Avatar generated! Check the output for the URL.');
                }
            } catch (error) {
                showOutput(`Error: ${error.message}`);
            } finally {
                showLoading('avatarLoading', false);
            }
        }
    </script>
</body>
</html>
