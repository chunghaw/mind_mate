<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mind Mate - Your AI Companion</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #f0f9f4 0%, #e0f2e9 100%);
            color: #2d3748;
            height: 100vh;
            overflow: hidden;
        }

        :root {
            --primary: #86efac;
            --primary-dark: #4ade80;
            --primary-light: #bbf7d0;
            --bg: #ffffff;
            --text: #2d3748;
            --text-light: #64748b;
            --border: #d1fae5;
            --shadow: rgba(134, 239, 172, 0.15);
        }

        /* Main Container */
        .app-container {
            display: flex;
            flex-direction: column;
            height: 100vh;
            max-width: 480px;
            margin: 0 auto;
            background: white;
            box-shadow: 0 0 40px rgba(0,0,0,0.1);
        }

        /* Header with Companion */
        .header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            padding: 16px 20px;
            color: white;
            display: flex;
            align-items: center;
            gap: 12px;
            box-shadow: 0 2px 10px var(--shadow);
            position: relative;
        }

        .companion-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            border: 3px solid rgba(255,255,255,0.5);
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .companion-info {
            flex: 1;
        }

        .companion-name {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 2px;
        }

        .companion-status {
            font-size: 12px;
            opacity: 0.9;
        }

        /* ML Wellness Badge */
        .wellness-badge {
            background: rgba(255,255,255,0.2);
            backdrop-filter: blur(10px);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .wellness-badge:hover {
            background: rgba(255,255,255,0.3);
        }

        .wellness-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #4ade80;
            animation: blink 2s ease-in-out infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Chat Container */
        .chat-container {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            background: #f8fafb;
        }

        /* Message Bubbles */
        .message {
            margin-bottom: 16px;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message.companion {
            display: flex;
            gap: 10px;
        }

        .message.user {
            display: flex;
            justify-content: flex-end;
        }

        .message-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: var(--primary-light);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            flex-shrink: 0;
        }

        .message-content {
            max-width: 75%;
        }

        .message-bubble {
            background: white;
            padding: 12px 16px;
            border-radius: 18px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            line-height: 1.5;
        }

        .message.companion .message-bubble {
            border-bottom-left-radius: 4px;
        }

        .message.user .message-bubble {
            background: var(--primary);
            color: white;
            border-bottom-right-radius: 4px;
        }

        .message-time {
            font-size: 11px;
            color: var(--text-light);
            margin-top: 4px;
            padding: 0 4px;
        }

        /* ML Insight Card */
        .ml-insight-card {
            background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
            border: 2px solid #93c5fd;
            border-radius: 16px;
            padding: 16px;
            margin-bottom: 16px;
            animation: slideIn 0.3s ease-out;
        }

        .ml-insight-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
            font-weight: 600;
            color: #1e40af;
        }

        .ml-insight-body {
            font-size: 14px;
            color: #1e3a8a;
            line-height: 1.6;
        }

        /* Activity Suggestion Card */
        .activity-card {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border: 2px solid #fbbf24;
            border-radius: 16px;
            padding: 16px;
            margin-bottom: 16px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .activity-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(251, 191, 36, 0.3);
        }

        .activity-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .activity-title {
            font-weight: 600;
            color: #92400e;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .activity-duration {
            font-size: 12px;
            color: #92400e;
            background: rgba(255,255,255,0.5);
            padding: 4px 8px;
            border-radius: 8px;
        }

        .activity-description {
            font-size: 13px;
            color: #78350f;
            line-height: 1.5;
        }

        /* Mood Quick Log */
        .mood-quick-log {
            background: white;
            border-radius: 16px;
            padding: 16px;
            margin-bottom: 16px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .mood-quick-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--text);
        }

        .mood-quick-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
        }

        .mood-quick-btn {
            aspect-ratio: 1;
            background: var(--bg);
            border: 2px solid var(--border);
            border-radius: 12px;
            font-size: 24px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 4px;
        }

        .mood-quick-btn:hover {
            transform: scale(1.05);
            border-color: var(--primary);
        }

        .mood-quick-label {
            font-size: 10px;
            color: var(--text-light);
        }

        /* Input Area */
        .input-area {
            background: white;
            border-top: 1px solid var(--border);
            padding: 12px 16px;
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .input-field {
            flex: 1;
            background: #f8fafb;
            border: 2px solid var(--border);
            border-radius: 24px;
            padding: 10px 16px;
            font-size: 14px;
            outline: none;
            transition: all 0.2s;
        }

        .input-field:focus {
            border-color: var(--primary);
            background: white;
        }

        .input-btn {
            width: 40px;
            height: 40px;
            background: var(--primary);
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .input-btn:hover {
            background: var(--primary-dark);
            transform: scale(1.05);
        }

        .input-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Quick Actions */
        .quick-actions {
            display: flex;
            gap: 8px;
            padding: 12px 16px;
            background: white;
            border-top: 1px solid var(--border);
            overflow-x: auto;
        }

        .quick-action-btn {
            background: var(--bg);
            border: 2px solid var(--border);
            border-radius: 20px;
            padding: 8px 16px;
            font-size: 13px;
            font-weight: 500;
            color: var(--text);
            cursor: pointer;
            transition: all 0.2s;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .quick-action-btn:hover {
            background: var(--primary-light);
            border-color: var(--primary);
        }

        /* Loading Animation */
        .typing-indicator {
            display: flex;
            gap: 4px;
            padding: 12px 16px;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--text-light);
            animation: typing 1.4s ease-in-out infinite;
        }

        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typing {
            0%, 60%, 100% {
                transform: translateY(0);
                opacity: 0.7;
            }
            30% {
                transform: translateY(-10px);
                opacity: 1;
            }
        }

        /* Modal Overlay */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 24px;
            max-width: 400px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 16px;
            color: var(--text);
        }

        .modal-close {
            float: right;
            font-size: 24px;
            cursor: pointer;
            color: var(--text-light);
        }

        /* Scrollbar */
        .chat-container::-webkit-scrollbar {
            width: 6px;
        }

        .chat-container::-webkit-scrollbar-track {
            background: transparent;
        }

        .chat-container::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 3px;
        }

        .chat-container::-webkit-scrollbar-thumb:hover {
            background: var(--primary);
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Header with Companion -->
        <div class="header">
            <div class="companion-avatar" id="companionAvatar">🐶</div>
            <div class="companion-info">
                <div class="companion-name" id="companionName">Mind Mate</div>
                <div class="companion-status" id="companionStatus">Here to support you</div>
            </div>
            <div class="wellness-badge" onclick="showWellnessDetails()">
                <div class="wellness-dot"></div>
                <span id="wellnessLevel">Good</span>
            </div>
        </div>

        <!-- Chat Container -->
        <div class="chat-container" id="chatContainer">
            <!-- Welcome Message -->
            <div class="message companion">
                <div class="message-avatar">🐶</div>
                <div class="message-content">
                    <div class="message-bubble">
                        Hey there! I'm your Mind Mate companion. I'm here to listen, support, and help you track your mental wellness. How are you feeling today?
                    </div>
                    <div class="message-time">Just now</div>
                </div>
            </div>

            <!-- ML Insight Example -->
            <div class="ml-insight-card">
                <div class="ml-insight-header">
                    <span>🧠</span>
                    <span>Wellness Insight</span>
                </div>
                <div class="ml-insight-body">
                    Your mood has been stable over the past week. Keep up the great self-care habits!
                </div>
            </div>

            <!-- Activity Suggestion Example -->
            <div class="activity-card" onclick="startActivity('breathing')">
                <div class="activity-header">
                    <div class="activity-title">
                        <span>🌬️</span>
                        <span>Deep Breathing</span>
                    </div>
                    <div class="activity-duration">5 min</div>
                </div>
                <div class="activity-description">
                    Take a moment to center yourself with guided breathing exercises
                </div>
            </div>

            <!-- Mood Quick Log -->
            <div class="mood-quick-log">
                <div class="mood-quick-title">Quick mood check-in</div>
                <div class="mood-quick-grid">
                    <button class="mood-quick-btn" onclick="quickMood(10, '😄')">
                        😄
                        <span class="mood-quick-label">Great</span>
                    </button>
                    <button class="mood-quick-btn" onclick="quickMood(7, '🙂')">
                        🙂
                        <span class="mood-quick-label">Good</span>
                    </button>
                    <button class="mood-quick-btn" onclick="quickMood(5, '😐')">
                        😐
                        <span class="mood-quick-label">Okay</span>
                    </button>
                    <button class="mood-quick-btn" onclick="quickMood(3, '😢')">
                        😢
                        <span class="mood-quick-label">Low</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="quick-actions">
            <button class="quick-action-btn" onclick="showMoodLog()">
                <span>💭</span>
                <span>Log Mood</span>
            </button>
            <button class="quick-action-btn" onclick="showActivities()">
                <span>✨</span>
                <span>Activities</span>
            </button>
            <button class="quick-action-btn" onclick="showStats()">
                <span>📊</span>
                <span>My Stats</span>
            </button>
            <button class="quick-action-btn" onclick="takeSelfie()">
                <span>📸</span>
                <span>Selfie</span>
            </button>
        </div>

        <!-- Input Area -->
        <div class="input-area">
            <input 
                type="text" 
                class="input-field" 
                id="messageInput" 
                placeholder="Share your thoughts..."
                onkeypress="handleKeyPress(event)"
            >
            <button class="input-btn" onclick="sendMessage()">
                ➤
            </button>
        </div>
    </div>

    <!-- Modal for Details -->
    <div class="modal-overlay" id="modalOverlay" onclick="closeModal()">
        <div class="modal-content" onclick="event.stopPropagation()">
            <span class="modal-close" onclick="closeModal()">×</span>
            <div class="modal-header" id="modalHeader">Details</div>
            <div id="modalBody"></div>
        </div>
    </div>

    <script>
        const API = "https://a5ttrfkhcr76hqo546gp3slfli0bkhlw.lambda-url.us-east-1.on.aws/";
        const USER_ID = "demo-user-" + Date.now();
        
        // Initialize
        window.onload = () => {
            loadProfile();
            loadWellnessStatus();
            scrollToBottom();
        };

        // Send Message
        function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            // Add user message
            addMessage('user', message);
            input.value = '';
            
            // Show typing indicator
            showTyping();
            
            // Simulate AI response
            setTimeout(() => {
                hideTyping();
                const responses = [
                    "I hear you. That sounds challenging. Would you like to talk more about it?",
                    "Thank you for sharing that with me. How does that make you feel?",
                    "I'm here for you. Let's work through this together.",
                    "That's a great insight. What would help you feel better right now?"
                ];
                const response = responses[Math.floor(Math.random() * responses.length)];
                addMessage('companion', response);
            }, 1500);
        }

        // Add Message to Chat
        function addMessage(type, text) {
            const container = document.getElementById('chatContainer');
            const time = new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
            
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}`;
            
            if (type === 'companion') {
                messageDiv.innerHTML = `
                    <div class="message-avatar">🐶</div>
                    <div class="message-content">
                        <div class="message-bubble">${text}</div>
                        <div class="message-time">${time}</div>
                    </div>
                `;
            } else {
                messageDiv.innerHTML = `
                    <div class="message-content">
                        <div class="message-bubble">${text}</div>
                        <div class="message-time">${time}</div>
                    </div>
                `;
            }
            
            container.appendChild(messageDiv);
            scrollToBottom();
        }

        // Typing Indicator
        function showTyping() {
            const container = document.getElementById('chatContainer');
            const typingDiv = document.createElement('div');
            typingDiv.className = 'message companion';
            typingDiv.id = 'typingIndicator';
            typingDiv.innerHTML = `
                <div class="message-avatar">🐶</div>
                <div class="message-content">
                    <div class="message-bubble">
                        <div class="typing-indicator">
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                        </div>
                    </div>
                </div>
            `;
            container.appendChild(typingDiv);
            scrollToBottom();
        }

        function hideTyping() {
            const typing = document.getElementById('typingIndicator');
            if (typing) typing.remove();
        }

        // Quick Mood Log
        function quickMood(value, emoji) {
            addMessage('user', `${emoji} Feeling ${getMoodLabel(value)}`);
            
            showTyping();
            setTimeout(() => {
                hideTyping();
                addMessage('companion', `Thanks for checking in! I've logged your mood. ${getEncouragement(value)}`);
                
                // Add activity suggestion if mood is low
                if (value <= 5) {
                    setTimeout(() => {
                        addActivitySuggestion();
                    }, 1000);
                }
            }, 1500);
        }

        function getMoodLabel(value) {
            if (value >= 9) return 'amazing';
            if (value >= 7) return 'good';
            if (value >= 5) return 'okay';
            if (value >= 3) return 'low';
            return 'struggling';
        }

        function getEncouragement(value) {
            if (value >= 7) return "Keep up the positive energy! 🌟";
            if (value >= 5) return "Every day is a new opportunity. 💚";
            return "I'm here for you. Would you like to try a calming activity?";
        }

        // Add Activity Suggestion
        function addActivitySuggestion() {
            const container = document.getElementById('chatContainer');
            const activityDiv = document.createElement('div');
            activityDiv.innerHTML = `
                <div class="activity-card" onclick="startActivity('meditation')">
                    <div class="activity-header">
                        <div class="activity-title">
                            <span>🧘</span>
                            <span>Guided Meditation</span>
                        </div>
                        <div class="activity-duration">10 min</div>
                    </div>
                    <div class="activity-description">
                        A calming meditation to help you feel more centered
                    </div>
                </div>
            `;
            container.appendChild(activityDiv);
            scrollToBottom();
        }

        // Start Activity
        function startActivity(type) {
            addMessage('user', '✨ Starting activity');
            showTyping();
            setTimeout(() => {
                hideTyping();
                addMessage('companion', "Great choice! Let's begin. Find a comfortable position and take a deep breath...");
            }, 1000);
        }

        // Show Wellness Details
        function showWellnessDetails() {
            document.getElementById('modalHeader').textContent = '🧠 Wellness Status';
            document.getElementById('modalBody').innerHTML = `
                <div style="padding: 16px 0;">
                    <div style="margin-bottom: 20px;">
                        <div style="font-size: 48px; text-align: center; margin-bottom: 12px;">😊</div>
                        <div style="text-align: center; font-size: 24px; font-weight: 700; color: #4ade80;">Good</div>
                        <div style="text-align: center; font-size: 14px; color: #64748b; margin-top: 4px;">
                            Your wellness indicators look positive
                        </div>
                    </div>
                    
                    <div style="background: #f0f9f4; border-radius: 12px; padding: 16px; margin-bottom: 12px;">
                        <div style="font-weight: 600; margin-bottom: 8px;">📊 Recent Patterns</div>
                        <div style="font-size: 14px; color: #64748b; line-height: 1.6;">
                            • Consistent mood tracking<br>
                            • Regular check-ins<br>
                            • Positive engagement
                        </div>
                    </div>
                    
                    <div style="background: #dbeafe; border-radius: 12px; padding: 16px;">
                        <div style="font-weight: 600; margin-bottom: 8px;">💡 Recommendation</div>
                        <div style="font-size: 14px; color: #1e3a8a; line-height: 1.6;">
                            Keep up your self-care routine! Consider trying a new activity today.
                        </div>
                    </div>
                </div>
            `;
            document.getElementById('modalOverlay').classList.add('active');
        }

        // Modal Functions
        function closeModal() {
            document.getElementById('modalOverlay').classList.remove('active');
        }

        // Quick Actions
        function showMoodLog() {
            addMessage('companion', "Let's log your mood! How are you feeling right now? You can use the quick buttons above or tell me more about it.");
        }

        function showActivities() {
            addMessage('companion', "Here are some activities I think you'd enjoy:");
            setTimeout(() => addActivitySuggestion(), 500);
        }

        function showStats() {
            addMessage('companion', "Let me pull up your wellness stats...");
            showTyping();
            setTimeout(() => {
                hideTyping();
                addMessage('companion', "You've checked in 12 times this week! Your average mood is 7.5/10. Great job staying consistent! 📊");
            }, 1500);
        }

        function takeSelfie() {
            addMessage('companion', "📸 Selfie feature coming soon! This will help me understand your emotions better through facial analysis.");
        }

        // Load Profile
        function loadProfile() {
            // Simulate loading user profile
            document.getElementById('companionName').textContent = 'Mind Mate';
            document.getElementById('companionStatus').textContent = 'Your Gentle Guardian';
        }

        // Load Wellness Status
        async function loadWellnessStatus() {
            // This would call the ML backend
            document.getElementById('wellnessLevel').textContent = 'Good';
        }

        // Utility Functions
        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        function scrollToBottom() {
            const container = document.getElementById('chatContainer');
            setTimeout(() => {
                container.scrollTop = container.scrollHeight;
            }, 100);
        }
    </script>
</body>
</html>
